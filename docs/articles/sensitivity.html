<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sensitivity Analysis • nlrx | NetLogo from R</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Sensitivity Analysis">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nlrx | NetLogo from R</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/getstarted.html">
    <span class="fa fa fa fa-magic"></span>
     
    Get Started
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-graduation-cap"></span>
     
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simdesign-examples.html">
        <span class="fa fa-book"></span>
         
        Simdesign examples
      </a>
    </li>
    <li>
      <a href="../articles/furthernotes.html">
        <span class="fa fa-sticky-note"></span>
         
        Advanced configuration
      </a>
    </li>
    <li>
      <a href="../articles/sensitivity.html">
        <span class="fa fa-sticky-note"></span>
         
        Sensitivity Analysis with nlrx
      </a>
    </li>
    <li>
      <a href="../articles/optimization.html">
        <span class="fa fa-sticky-note"></span>
         
        Optimization with nlrx
      </a>
    </li>
    <li>
      <a href="../articles/articles/spatial-output.html">
        <span class="fa fa-calculator"></span>
         
        Capturing spatial NetLogo output
      </a>
    </li>
    <li>
      <a href="../articles/articles/interfacing-different-models.html">
        <span class="fa fa-file-text-o"></span>
         
        Interfacing a variety of different NetLogo models
      </a>
    </li>
    <li>
      <a href="../articles/articles/nlrx_nldoc.html">
        <span class="fa fa-file-text-o"></span>
         
        NetLogo documentation with nlrx
      </a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-gears"></span>
     
    functions
  </a>
</li>
<li>
  <a href="https://github.com/nldoc/nlrx">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Sensitivity Analysis</h1>
                        <h4 class="author">Jan Salecker</h4>
            
            <h4 class="date">2019-09-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nldoc/nlrx/blob/master/vignettes/sensitivity.Rmd"><code>vignettes/sensitivity.Rmd</code></a></small>
      <div class="hidden name"><code>sensitivity.Rmd</code></div>

    </div>

    
    
<div id="sensitivity-analysis-with-nlrx" class="section level2">
<h2 class="hasAnchor">
<a href="#sensitivity-analysis-with-nlrx" class="anchor"></a>Sensitivity Analysis with nlrx</h2>
<p>Here we present a simple example for running a Morris Sensitivity Analysis with nlrx. We use the Wolf Sheep Predation model from the models library for this example.</p>
<div id="step-1-create-a-nl-object" class="section level4">
<h4 class="hasAnchor">
<a href="#step-1-create-a-nl-object" class="anchor"></a>Step 1: Create a nl object:</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nlrx)
<span class="co"># Windows default NetLogo installation path (adjust to your needs!):</span>
netlogopath &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="st">"C:/Program Files/NetLogo 6.0.3"</span>)
modelpath &lt;-<span class="st"> </span><span class="kw">file.path</span>(netlogopath, <span class="st">"app/models/Sample Models/Biology/Wolf Sheep Predation.nlogo"</span>)
outpath &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="st">"C:/out"</span>)
<span class="co"># Unix default NetLogo installation path (adjust to your needs!):</span>
netlogopath &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="st">"/home/NetLogo 6.0.3"</span>)
modelpath &lt;-<span class="st"> </span><span class="kw">file.path</span>(netlogopath, <span class="st">"app/models/Sample Models/Biology/Wolf Sheep Predation.nlogo"</span>)
outpath &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="st">"/home/out"</span>)

nl &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nl.html">nl</a></span>(<span class="dt">nlversion =</span> <span class="st">"6.0.3"</span>,
         <span class="dt">nlpath =</span> netlogopath,
         <span class="dt">modelpath =</span> modelpath,
         <span class="dt">jvmmem =</span> <span class="dv">1024</span>)</code></pre></div>
</div>
<div id="step-2-attach-an-experiment" class="section level4">
<h4 class="hasAnchor">
<a href="#step-2-attach-an-experiment" class="anchor"></a>Step 2: Attach an experiment</h4>
<p>In this example, we want to calculate sensitivity for 3 outputs (number of sheep, number of wolves, number of grass patches). We vary all numeric model parameters to estimate their sensitivity on the three defined output metrics. Thus, we define parameter ranges and distribution functions for all our numeric model parameters. We set the runtime of the model to 500 ticks and measure our metrics on each tick (<code>evalticks = "true"</code>). However, for calculation of sensitivity indices, we only want to consider the last 200 ticks. Thus, we set evalticks to <code>seq(300,500)</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nl<span class="op">@</span>experiment &lt;-<span class="st"> </span><span class="kw"><a href="../reference/experiment.html">experiment</a></span>(<span class="dt">expname =</span> <span class="st">"wolf-sheep-morris"</span>,
                            <span class="dt">outpath =</span> outpath,
                            <span class="dt">repetition =</span> <span class="dv">1</span>,   
                            <span class="dt">tickmetrics =</span> <span class="st">"true"</span>,
                            <span class="dt">idsetup =</span> <span class="st">"setup"</span>,  
                            <span class="dt">idgo =</span> <span class="st">"go"</span>,        
                            <span class="dt">runtime =</span> <span class="dv">500</span>,
                            <span class="dt">evalticks =</span> <span class="kw">seq</span>(<span class="dv">300</span>,<span class="dv">500</span>),
                            <span class="dt">metrics=</span><span class="kw">c</span>(<span class="st">"count sheep"</span>, <span class="st">"count wolves"</span>, <span class="st">"count patches with [pcolor = green]"</span>),
                            <span class="dt">variables =</span> <span class="kw">list</span>(<span class="st">"initial-number-sheep"</span> =<span class="st"> </span><span class="kw">list</span>(<span class="dt">min=</span><span class="dv">50</span>, <span class="dt">max=</span><span class="dv">150</span>, <span class="dt">step=</span><span class="dv">10</span>, <span class="dt">qfun=</span><span class="st">"qunif"</span>),
                                             <span class="st">"initial-number-wolves"</span> =<span class="st"> </span><span class="kw">list</span>(<span class="dt">min=</span><span class="dv">50</span>, <span class="dt">max=</span><span class="dv">150</span>, <span class="dt">step=</span><span class="dv">10</span>, <span class="dt">qfun=</span><span class="st">"qunif"</span>),
                                             <span class="st">"grass-regrowth-time"</span> =<span class="st"> </span><span class="kw">list</span>(<span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">100</span>, <span class="dt">step=</span><span class="dv">10</span>, <span class="dt">qfun=</span><span class="st">"qunif"</span>),
                                             <span class="st">"sheep-gain-from-food"</span> =<span class="st"> </span><span class="kw">list</span>(<span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">50</span>, <span class="dt">step=</span><span class="dv">10</span>, <span class="dt">qfun=</span><span class="st">"qunif"</span>),
                                             <span class="st">"wolf-gain-from-food"</span> =<span class="st"> </span><span class="kw">list</span>(<span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">100</span>, <span class="dt">step=</span><span class="dv">10</span>, <span class="dt">qfun=</span><span class="st">"qunif"</span>),
                                             <span class="st">"sheep-reproduce"</span> =<span class="st"> </span><span class="kw">list</span>(<span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">20</span>, <span class="dt">step=</span><span class="dv">5</span>, <span class="dt">qfun=</span><span class="st">"qunif"</span>),
                                             <span class="st">"wolf-reproduce"</span> =<span class="st"> </span><span class="kw">list</span>(<span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">20</span>, <span class="dt">step=</span><span class="dv">5</span>, <span class="dt">qfun=</span><span class="st">"qunif"</span>)),
                            <span class="dt">constants =</span> <span class="kw">list</span>(<span class="st">"model-version"</span> =<span class="st"> "</span><span class="ch">\"</span><span class="st">sheep-wolves-grass</span><span class="ch">\"</span><span class="st">"</span>,
                                             <span class="st">"show-energy?"</span> =<span class="st"> "false"</span>))</code></pre></div>
</div>
<div id="step-3-attach-a-simulation-design" class="section level4">
<h4 class="hasAnchor">
<a href="#step-3-attach-a-simulation-design" class="anchor"></a>Step 3: Attach a simulation design</h4>
<p>We use the <code>simdesgin_morris()</code> function to attach a Morris Sensitivity Analysis design. The <code>morrislevels</code> parameter sets the number of different values for each parameter (sampling density). The <code>morrisr</code> paramater sets the number of repeated samplings (sampling size). The <code>morrisgridjump</code> parameter sets the number of levels that are increased/decreased for computing the elemntary effects. Morris recommendation is to set this value to <code>levels / 2</code>. We can increase the <code>nseeds</code> parameter in order to perform multiple runs of the same parameter matrix with different random seeds. The variation between those repetitions is an indicator of the stochasticity effects within the model. More information on the Morris specific parameters can be found in the description of the morris function in the sensitivity package (<code>?morris</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nl<span class="op">@</span>simdesign &lt;-<span class="st"> </span><span class="kw"><a href="../reference/simdesign_morris.html">simdesign_morris</a></span>(<span class="dt">nl=</span>nl,
                                 <span class="dt">morristype=</span><span class="st">"oat"</span>,
                                 <span class="dt">morrislevels=</span><span class="dv">4</span>,
                                 <span class="dt">morrisr=</span><span class="dv">1000</span>,
                                 <span class="dt">morrisgridjump=</span><span class="dv">2</span>,
                                 <span class="dt">nseeds=</span><span class="dv">5</span>)</code></pre></div>
</div>
<div id="step-4-run-simulations" class="section level4">
<h4 class="hasAnchor">
<a href="#step-4-run-simulations" class="anchor"></a>Step 4: Run simulations</h4>
<p>To execute the simulations, we can use the function <code><a href="../reference/run_nl_all.html">run_nl_all()</a></code>. Sensitivity analyses typically have many runs that need to be simulated, thus we recommend to parallelize model runs by adjusting the future plan (more details on parallelization can be found in the “Advanced configuration” vignette).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(future)
<span class="kw">plan</span>(multisession)
results &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_nl_all.html">run_nl_all</a></span>(nl)</code></pre></div>
</div>
<div id="step-5-investigate-output" class="section level4">
<h4 class="hasAnchor">
<a href="#step-5-investigate-output" class="anchor"></a>Step 5: Investigate output</h4>
<p>First, we need to attach the results to the nl object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nl<span class="op">@</span>simdesign<span class="op">@</span>simoutput &lt;-<span class="st"> </span>results
<span class="kw">saveRDS</span>(nl, <span class="kw">file.path</span>(nl<span class="op">@</span>experiment<span class="op">@</span>outpath, <span class="st">"morris.rds"</span>))</code></pre></div>
<p>After results have been attached, we can use the <code><a href="../reference/analyze_nl.html">analyze_nl()</a></code> function to calculate morris sensetivity indices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">morris &lt;-<span class="st"> </span><span class="kw"><a href="../reference/analyze_nl.html">analyze_nl</a></span>(nl)</code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#sensitivity-analysis-with-nlrx">Sensitivity Analysis with nlrx</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jan Salecker, Marco Sciaini.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
